define(["theme_tilemmetry/jquery-asPieProgress","theme_tilemmetry/aspieprogress"],function(e,r){require(["jqueryui"],function(e){jQuery("#editprofile .form-horizontal #btn-save-changes").click(function(){jQuery("div#error-message").show(),jQuery("div#error-message").removeClass("alert-danger").addClass("alert-success"),jQuery("div#error-message p").html("Saving...");var r=jQuery("#first_name").val(),s=jQuery("#surname").val(),a=jQuery.trim(jQuery("#description").val()),e=jQuery.trim(jQuery("#city").val()),t=jQuery("#editprofile .form-horizontal #country option:selected").val();return""===r?(jQuery("div#error-message").show(),jQuery("div#error-message").removeClass("alert-success").addClass("alert-danger"),jQuery("div#error-message p").html(M.util.get_string("enterfirstname","theme_tilemmetry")),jQuery("#first_name").focus(),!1):""===s?(jQuery("div#error-message").show(),jQuery("div#error-message").removeClass("alert-success").addClass("alert-danger"),jQuery("div#error-message p").html(M.util.get_string("enterlastname","theme_tilemmetry")),jQuery("#surname").focus(),!1):void jQuery.ajax({type:"GET",async:!0,url:M.cfg.wwwroot+"/theme/tilemmetry/request_handler.php?action=save_user_profile_settings_ajax&fname="+r+"&lname="+s+"&description="+a+"&city="+e+"&country="+t+"&sesskey="+M.cfg.sesskey,success:function(e){jQuery("div#error-message").show(),jQuery("div#error-message").removeClass("alert-danger").addClass("alert-success"),jQuery("div#error-message p").css("margin","0").html(M.util.get_string("detailssavedsuccessfully","theme_tilemmetry")),jQuery(".profile-user").text(r+" "+s),jQuery(".usermenu a.navbar-avatar span.username").text(r+" "+s),jQuery("#user-description").text(a)},error:function(e,r,s){jQuery("div#error-message").removeClass("alert-success").addClass("alert-danger"),jQuery("div#error-message p").css("margin","0").html(r+" : "+s+", "+M.util.get_string("actioncouldnotbeperformed","theme_tilemmetry"))}})}),jQuery(".tilemmetry-course-progress").asPieProgress({namespace:"asPieProgress"})})});